<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org" xmlns="http://www.w3.org/1999/html">
<head>
    <title>연차 관리</title>
    <div th:replace="/fragments/header.html :: fragment-header"></div>
</head>
<body>
    <div class="container">
        <section>
            <div class='sub_btn_menu' style="margin: 0 0 15px 0;">
                <ul>
                    <a th:href="@{/annualStatus}" class='btn_line btn_gray' style="float: left;">현황</a>
                </ul>
                <ul>
                    <a th:href="@{/annualManagement}" class='btn_line btn_gray' style="float: left;">관리</a>
                </ul>
            </div>
            <div class="sub_content">
                <div class="sub_panel_box">
                    <table class="sub_table" th:object="${annual}">
                        <tr>
                            <th>1년차</th>
                            <td><input type="number" th:field="*{year1}" class="input_text"></td>
                            <th>2년차</th>
                            <td><input type="number" th:field="*{year2}" class="input_text"></td>
                            <th>3년차</th>
                            <td><input type="number" th:field="*{year3}" class="input_text"></td>
                            <th>4년차</th>
                            <td><input type="number" th:field="*{year4}" class="input_text"></td>
                        </tr>
                        <tr>
                            <th>5년차</th>
                            <td><input type="number" th:field="*{year5}" class="input_text"></td>
                            <th>6년차</th>
                            <td><input type="number" th:field="*{year6}" class="input_text"></td>
                            <th>7년차</th>
                            <td><input type="number" th:field="*{year7}" class="input_text"></td>
                            <th>8년차</th>
                            <td><input type="number" th:field="*{year8}" class="input_text"></td>
                        </tr>
                        <tr>
                            <th>9년차</th>
                            <td><input type="number" th:field="*{year9}" class="input_text"></td>
                            <th>10년차</th>
                            <td><input type="number" th:field="*{year10}" class="input_text"></td>
                            <th>11년차</th>
                            <td><input type="number" th:field="*{year11}" class="input_text"></td>
                            <th>12년차</th>
                            <td><input type="number" th:field="*{year12}" class="input_text"></td>
                        </tr>
                        <tr>
                            <th>13년차</th>
                            <td><input type="number" th:field="*{year13}" class="input_text"></td>
                            <th>14년차</th>
                            <td><input type="number" th:field="*{year14}" class="input_text"></td>
                            <th>15년차</th>
                            <td><input type="number" th:field="*{year15}" class="input_text"></td>
                            <th>16년차</th>
                            <td><input type="number" th:field="*{year16}" class="input_text"></td>
                        </tr>
                        <tr>
                            <th>17년차</th>
                            <td><input type="number" th:field="*{year17}" class="input_text"></td>
                            <th>18년차</th>
                            <td><input type="number" th:field="*{year18}" class="input_text"></td>
                            <th>19년차</th>
                            <td><input type="number" th:field="*{year19}" class="input_text"></td>
                            <th>20년차</th>
                            <td><input type="number" th:field="*{year20}" class="input_text"></td>
                        </tr>
                    </table>
                </div>
                <div style="text-align: center;">
                    <button type="button" class="btn btn-outline-secondary" th:onclick="annualUpdate()" style="margin-top: 20px; font-size: 13px;">저장</button>
                </div>
            </div>
        </section>
    </div>
<script>
    function annualUpdate() {
        if(confirm("저장하시겠습니까?")) {
            let params = {
                "year1" : getValue('#year1'),
                "year2" : getValue('#year2'),
                "year3" : getValue('#year3'),
                "year4" : getValue('#year4'),
                "year5" : getValue('#year5'),
                "year6" : getValue('#year6'),
                "year7" : getValue('#year7'),
                "year8" : getValue('#year8'),
                "year9" : getValue('#year9'),
                "year10" : getValue('#year10'),
                "year11" : getValue('#year11'),
                "year12" : getValue('#year12'),
                "year13" : getValue('#year13'),
                "year14" : getValue('#year14'),
                "year15" : getValue('#year15'),
                "year16" : getValue('#year16'),
                "year17" : getValue('#year17'),
                "year18" : getValue('#year18'),
                "year19" : getValue('#year19'),
                "year20" : getValue('#year20'),
            }

            fetch("/annualUpdate", {
                method: "PUT",
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(params)
            }).then((response) => {
                if(!response.ok) {
                    alert('연차 수정 중 오류 발생');
                }
                alert('저장되었습니다');
                window.location.href='/annualManagement';
            }).catch(e => {
                e.json().then(msg => {

                });
            });
        } else {
            return;
        }
    }
</script>
</body>
</html>